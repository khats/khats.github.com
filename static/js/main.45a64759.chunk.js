(this.webpackJsonpminesweeper=this.webpackJsonpminesweeper||[]).push([[0],{10:function(e,t,n){e.exports={desk:"styles_desk__DUIO6",row:"styles_row__DtQBb"}},14:function(e,t,n){e.exports={makeDecision:"styles_makeDecision__LpYTW"}},15:function(e,t,n){e.exports=n(22)},22:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(12),s=n.n(o),l=n(1),i=n(2),c=n(4),u=n(3),h=n(5),p=n(9);function f(e){return r.a.createElement("div",null,r.a.createElement("h3",null,"Variant 1: Autobot(no user interaction):"),r.a.createElement("button",{onClick:e.startBot},"start"))}function m(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"You lose"),r.a.createElement("button",{onClick:e.restartGame},"Restart"))}function v(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"Variant 2: Partial user interaction:"),r.a.createElement("span",null,"Select level:"),r.a.createElement("input",{type:"text",placeholder:"1,2,3,4 or other",onChange:e.changeLevel,value:e.level}),e.level?r.a.createElement("button",{onClick:e.startGame},"Start"):null)}var d=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).changeLevel=function(e){var t=e.target.value;/^[1-9]*$/.test(t)&&n.props.changeLevel(t)},n}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(f,{startBot:this.props.startBot}),r.a.createElement("hr",null),this.props.loose?r.a.createElement(m,{restartGame:this.props.restartGame}):r.a.createElement(v,{changeLevel:this.changeLevel,level:this.props.level?this.props.level:"",startGame:this.props.startGame})))}}]),t}(r.a.PureComponent);d.displayName="Controls";var g=d,E=n(8),b=n.n(E),j=n(10),y=n.n(j),w=n(6),O=n(7),x=n.n(O),k=n(13),N=n.n(k),_=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).open=function(){n.props.open(n.props.i,n.props.j)},n.setFlag=function(){n.props.setFlag(n.props.i,n.props.j)},n}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e,t=N()((e={},Object(w.a)(e,x.a.cell,!0),Object(w.a)(e,x.a.safe,this.props.value>=0),Object(w.a)(e,x.a.flag,-1===this.props.value),Object(w.a)(e,x.a.mine,-2===this.props.value),e));return r.a.createElement("span",{className:t,onClick:this.open,onContextMenu:this.setFlag},this.props.value)}}]),t}(r.a.PureComponent);_.displayName="Cell";var C=_,S=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).open=function(e,t){n.props.open(t,e)},n.setFlag=function(e,t){n.props.setFlag(t,e)},n}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props.matrix;return r.a.createElement("div",{className:y.a.desk},t.map((function(t,n){return r.a.createElement("div",{key:n,className:y.a.row},t.map((function(t,a){return r.a.createElement(C,{value:t,key:a,i:n,j:a,open:e.open,setFlag:e.setFlag})})))})))}}]),t}(r.a.PureComponent);S.displayName="Desk",S.propType={matrix:b.a.arrayOf(b.a.arrayOf(b.a.number))};var F=S,G=function(e){return"new ".concat(e)},L="map",R=function(e,t){return"open ".concat(e," ").concat(t)},q=function(){function e(t,n){Object(l.a)(this,e),this.connection=new WebSocket(t),this.connection.addEventListener("message",(function(e){n(e.data)})),this.connection.addEventListener("open",(function(){n("opened connection")}))}return Object(i.a)(e,[{key:"createGame",value:function(e){this.connection.send(G(e))}},{key:"getMap",value:function(){this.connection.send(L)}},{key:"openCell",value:function(e,t){this.connection.send(R(e,t))}}]),e}();function M(e){return r.a.createElement("div",null,"Passwords:",r.a.createElement("ul",null,e.passwords.map((function(e){return r.a.createElement("li",{key:btoa(e)},e)}))))}function B(e){return r.a.createElement("div",null,r.a.createElement("span",null,"Mines:"),r.a.createElement("span",null,e.minesCount))}var A=n(14),D=n.n(A);function P(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:e.next},"Autostep"),e.helpRequired?r.a.createElement("h3",{className:D.a.makeDecision},"Open cell, please! (Can not make decision)"):null)}var Y=[{i:-1,j:-1},{i:-1,j:0},{i:-1,j:1},{i:0,j:1},{i:1,j:1},{i:1,j:0},{i:1,j:-1},{i:0,j:-1}];function I(e,t,n,a){var r,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=[];return Y.forEach((function(l){(r=function(e,t,n,a,r){if(t<0||n<0||t>=e.length||n>=e[t].length)return null;var o=e[t][n];return!a&&isNaN(o)||!isNaN(o)&&(r?o===a:o>=a)?{row:t,cell:n}:null}(e,t+l.i,n+l.j,a,o))&&s.push(r)})),s}var W=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).resolver=function(e){if("opened connection"===e)n.setState({connected:!0});else if("new: OK"===e)n.setState({started:!0,matrix:[],loose:!1,helpRequired:!1},(function(){n.state.connection.getMap()}));else if(e.startsWith("map:")){var t=e.split(":")[1].split("\n").filter((function(e){return""!==e})).map((function(e){return e.split("")}));n.state.matrix===t.length&&t.forEach((function(e,a){e.forEach((function(e,r){isNaN(e)&&(t[a][r]=n.state.matrix[a][r])}))})),n.setState({matrix:t,helpRequired:!1})}else"open: You lose"===e?n.setState({started:!1,loose:!0}):"open: OK"===e||e.startsWith("open: You win")&&(n.state.passwords.includes(e)||n.setState({passwords:[].concat(Object(p.a)(n.state.passwords),[e]),level:n.state.level+1,matrix:[],started:!1}))},n.restartGame=function(){n.setState({matrix:[],started:!1,loose:!1,helpRequired:!1},(function(){n.startGame()}))},n.startGame=function(){n.state.connection.createGame(n.state.level)},n.open=function(e,t){n.state.connection.openCell(e,t),n.state.connection.getMap()},n.openList=function(e){e.forEach((function(e){n.state.connection.openCell(e.cell,e.row)})),n.state.connection.getMap()},n.setFlag=function(e,t){var a=n.state.matrix.map((function(e){return Object(p.a)(e)}));a[e][t]=-1,n.setState({matrix:a})},n.changeLevel=function(e){n.setState({level:e})},n.next=function(e){var t=[];if(n.state.matrix.forEach((function(e,n){e.forEach((function(e,a){-3===e&&t.push({row:n,cell:a})}))})),t.length)n.openList(t);else{var a=function(e){var t=e.map((function(e){return Object(p.a)(e)}));return t.forEach((function(e,n){return e.forEach((function(e,a){var r=parseInt(e);if(!isNaN(r)&&r>-1){I(t,n,a).forEach((function(e){t[e.row][e.cell]=-1}));var o=I(t,n,a,-1),s=I(t,n,a,-2);o.length>0&&o.length+s.length===r&&o.forEach((function(e){t[e.row][e.cell]=-2})),s.length>0&&s.length===r&&o.length>0&&o.forEach((function(e){t[e.row][e.cell]=-3}))}}))})),t.forEach((function(e,n){return e.forEach((function(e,a){var r=parseInt(e);if(!isNaN(r)&&r>-1){var o=I(t,n,a,-1),s=I(t,n,a,-2);s.length>0&&s.length===r&&o.length>0&&o.forEach((function(e){t[e.row][e.cell]=-3}))}}))})),t}(n.state.matrix),r=!1;if(a.forEach((function(e,t){e.forEach((function(e,a){e!==n.state.matrix[t][a]&&(r=!0)}))})),r)return void n.setState({matrix:a});if(n.state.autobot&&a.every((function(e){return e.every((function(e){return isNaN(e)}))})))return void n.open(Math.round(a[0].length/2),Math.round(a.length/2));if(!n.state.autobot)return void n.setState({helpRequired:!0});if(n.state.matrix.reduce((function(e,t){return e+t.filter((function(e){return isNaN(e)})).length}),0)<a.length*a[0].length*.05)return void n.setState({autobot:!1});for(var o=null,s=0,l=0;l<a.length;l++)for(var i=0;i<a[l].length;i++)if(isNaN(a[l][i])){var c=I(a,l,i,-2,!1);c>s&&(s=c,o={row:l,cell:i})}if(o)return void n.open(o.cell,o.row);for(var u=0;u<a.length;u++){for(var h=0;h<a[u].length;h++)if(-1===a[u][h]){o={row:u,cell:h};break}if(o)break}if(o)return void n.open(o.cell,o.row);n.setState({helpRequired:!0})}},n.startBot=function(){n.setState({autobot:!0},(function(){n.changeLevel(1)}))},n.state={matrix:[],connection:new q("wss://hometask.eg1236.com/game1/",n.resolver),level:null,started:!1,loose:!1,helpRequired:!0,autobot:!1,passwords:[],connected:!1},n}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(){this.state.autobot?this.state.loose?this.setState({matrix:[],started:!1,loose:!1}):this.state.level&&(0===this.state.matrix.length&&!this.state.started&&this.state.connected&&this.startGame(),this.state.matrix.length>0&&this.state.started&&this.next(null)):this.state.started&&this.state.matrix.length>0&&!this.state.helpRequired&&this.next(null)}},{key:"render",value:function(){var e=this.state.matrix.reduce((function(e,t){return e+t.filter((function(e){return-2===e})).length}),0);return r.a.createElement("div",{className:"App"},r.a.createElement(M,{passwords:this.state.passwords}),r.a.createElement("hr",null),r.a.createElement(g,{startGame:this.startGame,changeLevel:this.changeLevel,level:this.state.level,loose:this.state.loose,restartGame:this.restartGame,startBot:this.startBot}),r.a.createElement("hr",null),this.state.started?r.a.createElement(r.a.Fragment,null,r.a.createElement(B,{minesCount:e}),r.a.createElement(P,{helpRequired:this.state.helpRequired})):null,r.a.createElement(F,{matrix:this.state.matrix,open:this.open,setFlag:this.setFlag}))}}]),t}(r.a.Component);W.displayName="App";var J=W;s.a.render(r.a.createElement(J,null),document.getElementById("root"))},7:function(e,t,n){e.exports={cell:"styles_cell__XNJeH",safe:"styles_safe__2yXuU",flag:"styles_flag__1Y40j",mine:"styles_mine__MLcNf"}}},[[15,1,2]]]);
//# sourceMappingURL=main.45a64759.chunk.js.map